\section{Model}
  \subsection{Notation}
    \begin{itemize}
      \item We denote the set of all probability distributions on set $A$ as
      $\mathcal{D\left(A\right)}$.
      \item We denote the powerset of a set $A$ with $2^A$.
      \item $a \Vert b$ denotes the concatenation of $a$ and $b$.
    \end{itemize}

  \subsection{Properties of Post Voting Systems}
    A post voting system has the objective to arrange the posts according to the
    preferences of the participants. The ideal order is defined based on the
    likeability matrix for the posts.

    \begin{definition}[Post]
      Let $N \in \mathbb{N}^*, L_i \in \mathcal{D}\left(\left[0,
      1\right]^N\right)$. A post is defined as $p = \left(i, l(, v)\right)$,
      with $i \in \left[N\right], l \sim L_i$ (and $v \in \mathbb{R}_{+}$).
      \begin{itemize}
        \item \textbf{Author.} The first element of a post is the index of its
        creator, $i$.

        \item \textbf{Likeability.} The likeability of a post is defined as $l
        \in \left[0, 1\right]^N$(, where $l$ is drawn from $L_i$ the Likeability
        Distribution of its creator $u_i$).

        \item (\textbf{Votes.} A post has an associated ``vote'' value, which is a
        real non-negative number. It is initialized at 0 and increases whenever a
        player votes for the post, as explained later in detail.)
      \end{itemize}
      Let $P \in \mathbb{N}^*$ the number of posts. Then $\forall j \in
      \left[P\right],$ let $\mathrm{creator}_j \in \left[N\right], l_j \sim
      L_{\mathrm{creator}_j}$ and $p_j = \left(\mathrm{creator}_j, l_j(,
      0)\right)$. The set of all posts is $\mathcal{P} = \bigcup\limits_{j=1}^P
      \left\{p_j\right\}$.\footnote{TODO: consider removing things in
      parentheses}\fnmsep\footnote{TODO: consider dropping $L_i$ entirely}
    \end{definition}

    \begin{definition}[Post score]
      Let post $p = \left(m, l\right)$. We define the \emph{score} of $p$ as
      $\mathrm{sc}\left(p\right) = \sum\limits_{i = 1}^N l_i$.
    \end{definition}
    The score of a post is a single number that represents its overall worth to
    the community. By using simple summation, we assume that the opinions of all
    players have the same weight. In an ordered list of posts where higher posts
    are more visible, the ``common interest'' would require that a post with
    higher score appear before another post with a lower score.

    \begin{definition}[Ideal Post Order]
      Let $\mathcal{P}$ a set of posts. We define
      $\textsc{IdealOrder}\left(\mathcal{P}\right)$ as a list of the posts in
      $\mathcal{P}$ such that
      \begin{equation*}
        \forall i < j \in \left|\mathcal{P}\right|,
        \mathrm{sc}\left(\textsc{IdealOrder}
        \left(\mathcal{P}\right)\left[i\right]\right) \geq
        \mathrm{sc}\left(\textsc{IdealOrder}
        \left(\mathcal{P}\right)\left[j\right]\right) \enspace.
      \end{equation*}\footnote{TODO: discuss list notation}
    \end{definition}


  \subsection{Modeling Steem}
    \subsubsection*{Players}
      The are $N \in \mathbb{N}^{*}$ players in the model. A player $u$ is
      defined by her Steem Power $\mathrm{SP} \in \mathbb{N}$, her Voting Power
      $\mathrm{VP} \in \left[0, 1\right]$, her Likeability Distribution $L \in
    \begin{definition}[Player]
      Let $N \in \mathbb{N}^{*}$. A player $u$ is defined by her unique
      $\mathrm{id} \in \left[N\right]$, her Likeability Distribution $L \in
      \mathcal{D} \left(\left[0, 1\right]^N\right)$ and her Strategy $S \in
      \left\{H, G\right\} \times \mathbb{N}^* \times 2^{\left[N\right]}$. Let
      the $i$th player be represented by the tuple $u_i = \left(i, L_i,
      S_i\right)$. The tuple of players is defined as $\mathcal{U} = \left(u_1,
      \dots, u_i, \dots, u_N\right)$.

      We will now explain each field in $u_i$ in detail:
      \begin{itemize}
        \item \textbf{Likeability Distribution.} The Likeability Distribution
        $L_i \in \mathcal{D}\left([0,1]^N\right)$ of $u_i$ is a distribution on
        how likeable is the content produced by $u_i$ to the rest of the
        players. The Likeability Distribution for the whole system is
        $\mathcal{L} = \left(L_1, \dots, L_i, \dots, L_n\right)$.

        \item \textbf{Strategy.} The strategy of $u_i$ is defined as $S_i \in
        \lbrace H, G \rbrace \times \mathbb{N}^* \times 2^{\left[N\right]}$,
        where the first element is the player's core strategy, the second is her
        attention span and the third is her voting ring.
        \begin{itemize}
          \item \textbf{Honest/Greedy.} $H$ corresponds to the $honest$ and $G$
          to the $greedy$ strategy. An $honest$ player $u_i$ would vote a post
          $p$ according to its likeability towards herself, $l_{p, i}$, that is
          to say she votes posts following her preferences. (For $honest$
          players, the value of the vote is computed as $v_{H,i} = a \cdot
          \mathcal{VP} \cdot l \cdot \mathcal{SP} + b$, where $l$ is drawn from
          the Likeability distribution)\footnote{TODO: move to posts
          section}\fnmsep\footnote{TODO: explain $a$, $b$}. In Steem terms, $l$
          can be understood as the weight of a vote.

          A $greedy$ player only votes for posts produced by users of its Voting
          Ring. (The value of vote for a player if $u_i$ is $greedy$ is defined
          as $v_{G,i} = a \cdot \mathcal{VP}_i \cdot
          \mathcal{SP}_i$,\footnote{TODO: same} as in our model all $greedy$
          votes are executed with full weight.)

          \item \textbf{Attention Span.} This is a positive integer that
          represents the number of posts a player can consider voting
          simultaneously. For the benefit of simplicity, we will assume that this
          number is constant throughought all players.\footnote{TODO: discuss}

          \item \textbf{Voting Ring.}  If player $u_i$ is $honest$, her Voting
          Ring is $R_i = \emptyset$. If $u_i$ is $greedy$, her Voting Ring is $R_i
          \in 2^{\left[N\right]}$. A voting ring is defined as $R_i = \lbrace
          g_1, \dots, g_j, \dots, g_n \rbrace$ where $g_j \in \mathcal{U}$ is the
          $j$th member of the voting ring and $n$ is the size of the ring. Two
          $greedy$ players will either have the same or disjoint voting rings
          ($\forall i \neq j \in \left[N\right], R_i = R_j \vee \left(R_i \cap
          R_j = \emptyset\right)$).
        \end{itemize}
        The tuple of all strategies is defined as $\mathcal{S} = (S_1, \dots,
        S_i, \dots, s_N)$.
      \end{itemize}
      The set of players is defined as $\mathcal{U} = \left(u_1, \dots, u_i,
      \dots, u_N\right)$.
    \end{definition}

    \begin{definition}[Post-Voting System]
      An algorithm $F$ that accepts as inputs:
      \begin{itemize}
        \item list of posts (in some order)
        \item set of players
      \end{itemize}
      All posts must have a likeability vector of length equal to the number of
      players.

      The system returns an ordered list of the input posts, possibly reordered
    \end{definition}

    \begin{definition}[Honest Player v1]
      A player $u$ is considered \emph{honest} if her utility is maximized
      when the result of the post-voting system equals her subjective ordering
      of the posts:
      \begin{equation*}
        \forall i < j \in \left|\mathcal{P}\right|, l_{u, u\textsc{-Order}
        \left(\mathcal{P}\right)\left[i\right]} \geq l_{u, u\textsc{-Order}
        \left(\mathcal{P}\right)\left[j\right]}
        \enspace.
      \end{equation*}\footnote{TODO: discuss list notation}
    \end{definition}

    \begin{definition}[Honest Player v2]
      A player $u$ is considered \emph{honest} if she always votes the best post
      of the top $k$ (her attention span) with a weight equal to how much she
      likes the post.\footnote{TODO: discuss definition of honesty}
    \end{definition}

    \begin{definition}[Convergence under honesty]
      We say that a post-voting system $F$ $t$-\emph{converges under honesty}
      if, for every valid input $\left(\mathcal{P}, \mathcal{U}\right)$ where
      all players are honest, it is
      \begin{equation*}
        F\left(\mathcal{P}, \mathcal{U}\right)_{1..t} =
        \textsc{IdealOrder}\left(\mathcal{P}\right)_{1..t} \enspace.
      \end{equation*}
    \end{definition}

    \begin{theorem}
      The Steem system $t$-converges under honesty, assuming the following
      conditions on $N, P, \mathcal{SP}, v, att\_span, a, b, c$
      ...\footnote{TODO: continue}
    \end{theorem}

    The above result is tight.
    If the conditions are violated the above theorem is not true.

  \subsection{Steem Execution}
    \begin{algorithm}
      \caption{Each player creates one post}
      \label{alg:postGen}
      \begin{algorithmic}[1]
      \Function{GeneratePosts}{$\mathcal{U}$}
        \State $\mathcal{P} = \emptyset$ \Comment{List of posts}
        \For{$u_i \in \mathcal{U}$}
           \State $l \xleftarrow{r} L_i$
             \Comment{Get likeability of posts}
           \State $\mathcal{P} \leftarrow \mathcal{P} \Vert \left(i, l, 0\right)$
             \Comment{Add post to list of Posts}
        \EndFor
        \State $\mathcal{P} \leftarrow \textsc{Shuffle}(\mathcal{P})$
          \Comment{Shuffle posts to a random order}
        \State \Return $\mathcal{P}$
      \EndFunction
      \end{algorithmic}
    \end{algorithm}

    \begin{algorithm}%[H]
      \caption{Player votes for best of $k$ posts}
      \label{alg:vote}
      \begin{algorithmic}[1]
      \Function{Vote}{$u_i, \mathcal{P}$}
        \Switch{$S_i$}
          \Case{$honest$}
            \State $p_j \leftarrow \argmax\limits_{p \in \mathcal{P}_{1 ..
              k}}{\lbrace l_{i, p}\rbrace}$
            \State Parse $p_j$ as $\left(m, l_p, v\right)$
            \State $v' \leftarrow v + a \cdot \mathrm{VP}_i \cdot l_{i, p} \cdot
            \mathrm{SP}_i + b$
            \State $\mathrm{VP}_i \gets \mathrm{VP}_i - \left(a \cdot
            \mathrm{VP}_i \cdot l_{i, p} + b\right)$
            \State $\mathcal{P} \leftarrow p_1 \Vert p_2 \Vert \dots \Vert
            p_{j-1} \Vert \left(m, l_p, v'\right) \Vert p_{j+1} \Vert \dots \Vert
            p_N$
          \EndCase

          \Case{$Greedy$}
             \State
               \Comment{If post belongs to voting ring and not reached min
               VPower}
             \If{$p \in s.R $ $\land $ $p.VPower > s.Min$}
               \State $voteValue \leftarrow p.VPower \cdot weight \cdot sp$
               \State $p \leftarrow p.votes +  voteValue$
             \EndIf
          \EndCase
        \EndSwitch

        \State \Return $\mathcal{P}$
      \EndFunction
      \end{algorithmic}
    \end{algorithm}
    TODOS\footnote{TODO: Improve argmax notation}\fnmsep\footnote{TODO: Write Greedy}

    \begin{algorithm}[H]
      \caption{Players cast votes for $r$ rounds}
      \label{alg:curation}
      \begin{algorithmic}[1]
      \Function{Curate}{$\mathcal{U}, \mathcal{P}, r$}
        \For{$j = 1$ to $r$}
          \Comment{$r$ voting rounds}
          \For {$u_i \in \mathcal{U}$}
            \If{\textsc{IsVoteRound}$\left(j, S_i, r, N\right)$}
              \State $\mathcal{P} \leftarrow \textsc{Vote}\left(u_i,
              \mathcal{P}\right)$
                \Comment{Player $i$ votes zero or one posts}
            \EndIf
          \EndFor
          \State $\mathcal{P} \leftarrow \textsc{Order}\left(\mathcal{P}\right)$
            \Comment{Order posts by vote count after each round of votes}
        \EndFor
        \State \Return $\mathcal{P}$
      \EndFunction
      \end{algorithmic}
    \end{algorithm}

    \begin{algorithm}[H]
      \caption{Calculates whether voting in this round is optimal}
      \label{alg:isvoteround}
      \begin{algorithmic}[1]
        \Function{IsVoteRound}{$j, S, r, N$}
          \State 
        \EndFunction
      \end{algorithmic}
    \end{algorithm}

    \begin{algorithm}[H]
      \caption{Steem$\left(\mathcal{U}, \mathcal{P}, r\right)$}
      \label{alg:main}
      \begin{algorithmic}[1]
      \State $\mathcal{P} \leftarrow \textsc{Curate}\left(\mathcal{U},
      \mathcal{P}, r\right)$
      \State \Return $\mathcal{P}$
      \end{algorithmic}
    \end{algorithm}
